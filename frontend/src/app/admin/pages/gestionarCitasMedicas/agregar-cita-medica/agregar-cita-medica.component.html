
<div class="alert alert-warning" role="alert">
  Si no tienes médicos registrados en la aplicación o no sabes qué días trabajan tus médicos 
  <button class="btn btn-info" (click)="irAGestionarHorarios()">Revisa los horarios aquí</button>
</div>


<form (ngSubmit)="guardarCita()">

  <!-- Motivo de la cita -->


 <!-- Paciente -->
 <div class="form-group mb-3">
  <label for="paciente">Paciente</label>
  <select class="form-control" id="paciente" [(ngModel)]="selectedPaciente" name="paciente">
    <option value="" disabled>Seleccione un paciente</option>
    <option *ngFor="let paciente of pacientes" [value]="paciente.rut">{{ paciente.nombre }} {{ paciente.apellidos }}</option>
  </select>
</div>

<!-- Especialidad Médica -->
<div class="form-group mb-3">
  <label for="especialidad">Especialidad</label>
  <select class="form-control" id="especialidad" [(ngModel)]="selectedEspecialidad" (change)="onChangeData()" name="especialidad">
    <option value="" disabled selected>Seleccione una especialidad</option>
    <option *ngFor="let especialidad of especialidades" [value]="especialidad.especialidad_medica">{{ especialidad.especialidad_medica }}</option>
  </select>
</div>

  
<div class="form-group mb-3">
  <label for="fecha">Fecha de cita</label>
  <input type="date" class="form-control" id="fecha" [(ngModel)]="selectedDate" (change)="onChangeData()" name="fecha">
</div>

  
<div class="form-group mb-3" *ngIf="medicosDisponibles && medicosDisponibles.length">
  <label for="medico">Médicos disponibles</label>
  <select class="form-control" id="medico" [(ngModel)]="selectedMedico" name="medico" (change)="onMedicoSelected($event)">
    <option *ngFor="let medico of medicosDisponibles" [ngValue]="medico">{{ medico.medicoNombre }} {{ medico.idTipoCita }}  ({{ medico.hora_inicio }} - {{ medico.hora_fin }})</option>
  </select>
  
</div>
<div *ngIf="selectedMedico && selectedMedico.rutMedico">
  
  <p>Nombre del Médico: {{ selectedMedico.medicoNombre }}</p>
  <p>Horario: {{ selectedMedico.hora_inicio }} - {{ selectedMedico.hora_fin }}</p>
 
</div>


<button type="submit" class="btn btn-primary" [disabled]="!formularioValido()">Guardar Cita</button>




</form>
<!-- Coloca esto DESPUÉS del formulario y ANTES del mensaje de advertencia -->
<div class="row g-4 mt-4">
  <div class="col-12">
    <h4 class="mb-3 text-secondary">Disponibilidad por día</h4>
    <div class="alert alert-info shadow-sm">
      <i class="bi bi-info-circle me-2"></i>
      Consulta las especialidades disponibles por día para programar citas.
    </div>
    <div class="row g-3">
      <div class="col-md-3 col-sm-6" *ngFor="let dia of ordenDias">
        <div class="card h-100 border-start-4 border-primary shadow-sm hover-shadow">
          <div class="card-body">
            <h5 class="card-title text-primary">
              <i class="bi bi-calendar-event me-2"></i>{{ dia | titlecase }}
            </h5>
            <ul class="list-group list-group-flush">
              <li class="list-group-item d-flex align-items-center" 
                  *ngFor="let especialidad of horariosEspecialidades[dia]">
                <i class="bi bi-check2-circle text-success me-2"></i>
                {{ especialidad }}
              </li>
              <li class="list-group-item text-muted small" 
                  *ngIf="!horariosEspecialidades[dia]?.length">
                No hay especialidades este día
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

